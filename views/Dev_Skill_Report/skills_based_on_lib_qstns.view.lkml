view: skills_based_on_lib_qstns {
    derived_table: {
      sql: with lib_q_skill_map as
                          (
                          select
                          question_id,
                          question_skills_obj as skills,
                          seq.n,
                          json_array_length(question_skills_obj, true) as no_of_skills,
                          json_extract_path_text(json_extract_array_element_text(cq.question_skills_obj,seq.n, true),'name', true) as skill,
                          case when json_extract_path_text(json_extract_array_element_text(cq.question_skills_obj,seq.n, true),'name', true) like '% (Basic)%' then rtrim(json_extract_path_text (json_extract_array_element_text(cq.question_skills_obj,seq.n, true),'name', true), '(Basic)')
                              when json_extract_path_text(json_extract_array_element_text(cq.question_skills_obj,seq.n, true),'name', true) like '% (Advanced)%' then rtrim(json_extract_path_text(json_extract_array_element_text(cq.question_skills_obj,seq.n, true),'name', true), '(Advanced)')
                              when json_extract_path_text(json_extract_array_element_text(cq.question_skills_obj,seq.n, true),'name', true) like '% (Intermediate)%' then rtrim(json_extract_path_text(json_extract_array_element_text(cq.question_skills_obj,seq.n, true),'name', true), '(Intermediate)')
                              else json_extract_path_text(json_extract_array_element_text(cq.question_skills_obj,seq.n, true),'name', true) end as modified_skill_name, -- Considering all 3 skills (basic, intermediate and advanced as one) )
                          json_extract_path_text(json_extract_array_element_text(cq.question_skills_obj,seq.n, true),'unique_id', true) as skill_unique_id
                          from hr_analytics.global.dim_content_questions cq
                          inner join
                            (select row_number() over(order by true)::integer - 1 as n from hr_analytics.global.dim_content_questions limit 20) seq
                          on seq.n <= json_array_length(question_skills_obj, true) - 1
                            and question_product = 1
                            and question_id in
                                          --   (select DISTINCT json_extract_array_element_text(rl.library_questions, seq.rn) as qid
                                          --   from hr_analytics.global.fact_recruit_library as rl,
                                          --       (select row_number() OVER (order by true)::integer - 1 as rn from hr_analytics.global.dim_content_questions limit 5000) as seq
                                          --   where seq.rn < JSON_ARRAY_LENGTH(rl.library_questions) and rl.library_id IN (1,2,3,110,162,166,383,990)
                                          --   )

      (
      2,
1494605,
1438737,
358,
380499,
754640,
334943,
226820,
1150239,
1076386,
995188,
781206,
918407,
791413,
1117587,
1138912,
326211,
731269,
315,
1463725,
1162090,
337,
242228,
145710,
1106495,
1212994,
192421,
226850,
226874,
667503,
740520,
991628,
924066,
987907,
987931,
668856,
6934,
359,
807618,
1437467,
106901,
151023,
161991,
1278532,
209418,
660736,
622264,
889665,
859271,
988863,
1162118,
1162124,
373097,
222927,
27,
789798,
1009993,
806336,
1438167,
1299485,
1256029,
1235168,
1201629,
377692,
308154,
558358,
664240,
688861,
1141281,
186,
140383,
142949,
147287,
757897,
1120874,
1093937,
928172,
887201,
832718,
1118586,
145714,
6762,
1395254,
144955,
982723,
111178,
1046663,
890297,
241354,
600981,
1058907,
987914,
983612,
145565,
1369735,
1236085,
1144207,
620616,
151027,
999750,
1463726,
1463013,
1445841,
1376157,
1321847,
781195,
1245787,
684418,
927507,
1119074,
1140971,
418082,
1469414,
1463676,
136085,
890473,
1397490,
1324804,
319971,
1118402,
391623,
684419,
987908,
1144205,
171073,
145055,
798977,
111730,
201,
1438486,
1430119,
804731,
276,
130341,
145035,
145066,
561430,
724559,
192361,
1239879,
1218717,
1058868,
756803,
884149,
1061885,
477437,
257,
1011364,
725697,
1010954,
1266486,
1219054,
670420,
987910,
1154428,
1230914,
1392621,
984754,
146259,
149144,
151028,
1063272,
1056259,
670613,
921093,
1203239,
788003,
130445,
111165,
145953,
160084,
192420,
902476,
6821,
995515,
157958,
1266284,
1171529,
378769,
480206,
617426,
754349,
268,
883913,
1405686,
145050,
1355152,
192379,
1269381,
1255828,
1248964,
326246,
905135,
724359,
185571,
330,
299,
13,
108936,
141,
133365,
223,
267,
1412488,
1399855,
373100,
555004,
754840,
1259804,
222914,
1201734,
569451,
1060364,
932156,
924072,
755114,
1010687,
1138945,
226897,
1201630,
991697,
1230088,
106,
1481653,
111858,
56,
62,
104,
133143,
1445884,
241129,
743716,
226819,
226855,
991621,
1059257,
1160967,
337442,
1438169,
908940,
333418,
36,
991626,
226878,
1190912,
1141189,
377687,
355,
1494603,
1020992,
1326035,
1275483,
1269761,
1234784,
1201625,
380495,
1031779,
1123790,
1083501,
1060370,
360,
145704,
1269395,
1213081,
242230,
317719,
1122867,
635739,
641556,
1058764,
1059496,
1182113,
145705,
139,
1494597,
1470786,
1414921,
887815,
307703,
145734,
1290393,
192380,
1239652,
1117130,
226899,
134053,
145578,
192382,
1225904,
241137,
975704,
991709,
130484,
192413,
1382211,
743698,
1291220,
226787,
285547,
600278,
641085,
921104,
987952,
561216,
150782,
186818,
325544,
645911,
781202,
327,
241138,
265920,
637455,
29,
87,
1407183,
1158602,
209364,
226856,
241143,
1192814,
953845,
1182094,
377685,
1219051,
132426,
1162136,
135675,
983048,
145733,
795851,
1274115,
212896,
1230190,
226896,
1201622,
296164,
1019100,
1040950,
763936,
1123881,
1100748,
480351,
315971,
226904,
110,
72,
684760,
130347,
357,
145029,
1386311,
151274,
685823,
755194,
1277500,
1137362,
226867,
226891,
1141188,
1123234,
321536,
528185,
995112,
993701,
968272,
987912,
226889,
1230082,
127473,
1429546,
1299499,
215879,
988864,
1201620,
1195202,
1091233,
1056315,
722147,
328576,
24,
1004869,
1076301,
1461338,
229,
226806,
1244472,
377690,
1058887,
1031791,
689495,
705783,
1054358,
483758,
5395,
149,
40,
146237,
160086,
288,
253248,
1392648,
148570,
157962,
192392,
226834,
1234776,
1108666,
661118,
995493,
1089207,
532054,
1140140,
1481359,
792367,
789123,
216,
274,
144932,
6836,
1376357,
226785,
226893,
1059850,
623480,
1054339,
1043335,
1115124,
1192775,
336,
1442118,
136072,
146700,
466981,
1308037,
226817,
1231056,
1195354,
417582,
1093078,
645384,
642666,
685546,
660671,
1059606,
1182116,
1099992,
15,
1043321,
241150,
1379649,
1214371,
321524,
549551,
1016976,
34,
1445875,
264,
106887,
1384882,
186812,
1275856,
209370,
466924,
1059522,
1138929,
991700,
730443,
1479602,
145798,
1319445,
1253861,
1203791,
134054,
136342,
830164,
281,
241132,
145023,
1305768,
209559,
987933,
1121799,
804242,
763816,
1445882,
193,
879036,
848128,
311,
145700,
991624,
1239272,
226832,
226844,
304751,
356748,
1100755,
1043748,
1008968,
995109,
757889,
950463,
890281,
830922,
349828,
1429127,
145591,
1379461,
209360,
226807,
242239,
920929,
781191,
987924,
1192777,
1230182,
136043,
1043270,
133254,
175,
1182119,
315744,
701402,
921102,
1031782,
311474,
991699,
681645,
823651,
887826,
1290392,
226790,
801975,
1122838,
314749,
204497,
503252,
1467185,
103,
1395304,
326,
968517,
1290998,
226782,
1214998,
527467,
554918,
1061902,
993716,
860423,
945598,
864952,
54,
1480702,
798567,
1438729,
152899,
1300031,
1291352,
1290430,
1274151,
226894,
314442,
640260,
1142494,
96,
58,
127576,
1076177,
1463570,
133696,
200934,
1066440,
1201638,
1230248,
151287,
20,
9,
1162100,
834544,
829697,
266,
924672,
377691,
440905,
1365991,
149217,
1274093,
255044,
287480,
580973,
1091251,
748395,
839361,
749426,
871450,
241,
873279,
222929,
192393,
948160,
33,
145737,
250500,
934238,
921094,
1054338,
1150237,
1118400,
1494601,
1417515,
1230387,
226871,
294963,
1117060,
988862,
138976,
127505,
820075,
241141,
142947,
1396165,
209560,
1238373,
1144133,
1202011,
141297,
16,
743686,
209396,
1155553,
850319,
701638,
1058760,
1141184,
1177854,
69,
160137,
111173,
1361541,
148567,
1290925,
1058906,
1182093,
555314,
1089196,
1031786,
1021908,
993692,
1059364,
1056323,
1058865,
1182108,
1144142,
1186340,
1141071,
991691,
798927,
202,
137133,
149216,
1321867,
1308429,
186813,
216361,
1125080,
558403,
1093769,
979511,
898557,
1182115,
151000,
145701,
1230194,
44,
1043452,
130513,
794690,
1096462,
145600,
1306065,
1296405,
1058913,
1121834,
591119,
685846,
668865,
661482,
1058895,
1059615,
554079,
1463634,
549550,
1324090,
157141,
778394,
934198,
1275496,
1219046,
1193957,
356642,
472553,
1031777,
1117408,
1100904,
144952,
51,
22,
135071,
894838,
1272020,
1251076,
246730,
451038,
348983,
1060100,
668864,
320475,
1201621,
1058750,
123263,
111168,
263,
186828,
1012415,
1182106,
1144206,
1201754,
1196368,
1091856,
626184,
751526,
987951,
1177838,
287,
1387930,
186827,
997049,
1369736,
226797,
226895,
1215004,
1058208,
668863,
998334,
991257,
1140981,
1177849,
41,
160089,
1429553,
1380137,
1329486,
569360,
226849,
622265,
995144,
322571,
1225903,
207299,
1479605,
135678,
280,
1387036,
146708,
1173844,
150954,
781611,
1271776,
994121,
1059015,
1162129,
1194105,
876655,
145012,
1376164,
1369729,
1348819,
934246,
226883,
994985,
1201627,
1177836,
991713,
1461351,
1438171,
1401213,
145056,
145073,
147234,
145695,
580983,
1077954,
1059077,
1058755,
225,
269,
900732,
145040,
226780,
1191869,
603694,
1225900,
1203079,
137671,
894822,
150951,
145736,
1321825,
186815,
1266854,
1182118,
349060,
637453,
643135,
995483,
841052,
794694,
1192727,
1192770,
89,
214,
136681,
1419357,
827337,
142952,
896601,
754912,
1300034,
778391,
160471,
186822,
929538,
1215016,
338306,
1091869,
1058884,
668855,
934190,
916134,
1058905,
575081,
1061894,
1192776,
1230080,
369,
117,
132318,
186829,
203144,
1154671,
226800,
226812,
222923,
232646,
555179,
668868,
687484,
828826,
1005103,
1144199,
1189045,
111164,
26,
138985,
1392651,
970661,
150828,
192370,
1269892,
1059873,
586739,
1054495,
716477,
1117570,
350161,
1060368,
318334,
1219052,
146108,
145046,
146,
1479599,
149146,
1299486,
186819,
1275514,
1274685,
192369,
1162130,
1235272,
1089205,
643131,
1022019,
759740,
1100746,
1100907,
145593,
133698,
1171930,
1279249,
934245,
209415,
226810,
226870,
226882,
1131690,
1064708,
668851,
975693,
1123797,
1140979,
147220,
206,
860322,
133670,
241155,
151019,
209365,
226809,
226833,
352660,
1020961,
757890,
926447,
879939,
987950,
618520,
1139013,
794693,
222917,
116387,
1296422,
992783,
554080,
1144117,
150999,
146327,
730562,
375305,
1299497,
226839,
995117,
722784,
987932,
1141183,
1215008,
1235499,
1230087,
686470,
218,
246731,
151022,
595244,
701649,
687485,
1118172,
1182097,
185576,
134055,
241133,
1392653,
1379511,
685814,
759891,
1294763,
1177853,
1445887,
140380,
1173912,
1253924,
580978,
642707,
1059094,
1479606,
1096984,
254,
295,
132990,
159956,
926448,
287481,
1151704,
481761,
896287,
806741,
1119121,
610044,
1191695,
1061888,
1221288,
1230191,
166,
38,
826087,
1463571,
135993,
241154,
145006,
1389615,
153871,
209412,
312525,
1067262,
921097,
987949,
1112616,
146099,
145590,
129099,
111169,
107161,
730751,
145107,
219,
160162,
144943,
1382208,
754639,
153901,
1296940,
1275560,
1271922,
573598,
598407,
995175,
987929,
743708,
661428,
554083,
1116675,
730784,
121,
1443730,
140384,
328,
185564,
1290121,
1162133,
241142,
1196883,
1056234,
668867,
905129,
946284,
1155655,
380512,
991705,
101,
25,
1162284,
865844,
880763,
829077,
144984,
1056325,
1267222,
226842,
1154654,
781203,
986796,
920939,
1058903,
1059861,
587908,
1230818,
127485,
832088,
815360,
876774,
336895,
1331561,
925217,
807753,
757896,
987927,
988861,
312517,
1144195,
230426,
8499,
1472124,
847685,
136698,
304,
1299482,
161103,
1266943,
1266278,
338341,
993655,
894595,
1117600,
1092364,
311408,
1105639,
151024,
162458,
1157208,
212905,
637452,
1064243,
1141177,
1154946,
1061887,
1218522,
45,
197,
835915,
224,
1429534,
743685,
750142,
1296367,
159958,
322204,
1071523,
832719,
1040889,
988854,
46,
761437,
1096842,
1437666,
569447,
1299472,
161849,
318335,
1093786,
171075,
161850,
192368,
1235273,
1194966,
326256,
730537,
133601,
1429532,
144966,
1379514,
1324794,
153919,
1294873,
226840,
226888,
1071514,
1022796,
1144130,
1195850,
50,
132422,
177,
205,
240,
136078,
6758,
32,
685797,
1269365,
111171,
1238843,
1125009,
1116652,
1083670,
1059008,
743704,
723522,
432913,
1118395,
126,
1473146,
124,
133664,
241130,
1384725,
146323,
1019006,
1174186,
198652,
1230061,
1190219,
816565,
1089088,
482837,
226792,
133687,
211,
95,
876636,
135691,
1400043,
1376158,
149125,
995485,
924682,
635793,
1192772,
991712,
1230090,
132087,
130302,
827372,
146322,
1334682,
151289,
1158600,
1155863,
641924,
1076518,
1058212,
618754,
919329,
861746,
1019783,
1060356,
132654,
1443782,
1379507,
1363141,
145743,
1326053,
1077845,
618610,
998177,
102,
391998,
37,
1467178,
144933,
145728,
536416,
754680,
1259809,
315642,
1089072,
614089,
667682,
1058845,
1040888,
373099,
299452,
1100859,
118525,
134078,
1419217,
157957,
1171929,
1332723,
157959,
212892,
1249571,
1218722,
1189890,
321307,
398150,
1096985,
641031,
724357,
926479,
955245,
1089192,
317734,
1201888,
43,
136581,
222,
1428470,
145051,
145687,
1212993,
1275559,
1259805,
226825,
1212143,
1174132,
1201739,
108999,
1442105,
138303,
1392662,
931584,
186816,
1275180,
443606,
1091942,
685850,
1056255,
1140962,
1154949,
127617,
1467175,
1040241,
145784,
148579,
1274147,
226847,
323021,
898648,
1121902,
1467186,
144923,
984379,
1271322,
418844,
934193,
920942,
903137,
326254,
53,
835795,
807881,
1100261,
135680,
1275524,
306091,
920944,
1182102,
1043057,
140387,
144930,
981943,
852900,
575121,
226784,
1202469,
296977,
724354,
1089083,
569349,
1163263,
317843,
303479,
1100881,
147537,
991704,
801133,
834152,
1353339,
145744,
1203061,
589059,
921096,
670615,
555003,
313725,
1144138,
226851,
1177851,
354,
8,
686465,
135929,
238,
146328,
1259807,
226824,
323785,
1144197,
884146,
1058770,
1059225,
987917,
1230059,
200,
76,
320807,
365,
1380062,
921101,
226802,
1071533,
588397,
988865,
479504,
391632,
1154419,
1060363,
226858,
109040,
731001,
335,
878782,
781931,
284,
145074,
754888,
209355,
226854,
1182101,
670052,
584265,
1046611,
1059087,
569445,
1043124,
59,
860334,
804126,
793950,
128,
135689,
1387288,
153898,
1059525,
212893,
1231054,
1238850,
1215003,
1076225,
757891,
934237,
991701,
145039,
133658,
761161,
788006,
249,
145008,
1386299,
153872,
186823,
192391,
1158626,
226821,
226869,
635744,
612791,
988872,
685796,
1118573,
160411,
991623,
1096964,
558359,
192419,
1155867,
226837,
226873,
932257,
1058925,
987918,
1162825,
136713,
255,
1251555,
1211970,
519241,
1094068,
1056312,
901997,
603696,
144549,
1428536,
146109,
755086,
1238849,
1088484,
659522,
1162117,
1182114,
1100816,
131565,
822901,
145026,
1363173,
1324128,
1291109,
192353,
226853,
832714,
353083,
987922,
135852,
1299494,
1290384,
186817,
192352,
192367,
1239379,
1235277,
313923,
722813,
1059848,
1158511,
1481647,
837171,
157,
1438165,
216042,
1392650,
1353265,
1259819,
832716,
279105,
1055872,
667440,
940203,
725750,
730997,
1480698,
252,
277,
141295,
145596,
670463,
1218715,
373096,
406783,
1121908,
643127,
617208,
1004578,
897736,
988876,
1119008,
1138937,
145833,
7179,
208,
246,
1400355,
895679,
6794,
309,
148641,
147388,
1274684,
192388,
1252580,
1154468,
553142,
849109,
887112,
1089089,
1142482,
377686,
1121543,
1230810,
79,
794551,
134084,
828465,
135700,
1427644,
890474,
974983,
1387037,
145052,
1376024,
169104,
1211972,
553141,
1059147,
987920,
701501,
1144204,
1206413,
82,
1324119,
192387,
533802,
655669,
847684,
668842,
1141298,
1201635,
161180,
140388,
133701,
730775,
235,
192412,
149175,
1275482,
1255832,
226822,
230626,
432108,
39,
833757,
1467182,
890299,
135687,
1174192,
1361434,
322021,
554082,
645419,
1138918,
1155585,
302941,
1479633,
135693,
144946,
326248,
757075,
1269374,
829935,
1056246,
1019351,
1142498,
1230089,
730995,
313,
1329429,
1245753,
1239603,
1218516,
722840,
1125033,
308704,
1144126,
798932,
1460933,
817692,
149177,
716263,
1290406,
1269382,
1058210,
1142495,
347979,
1201735,
135681,
1422308,
1392620,
145741,
1211618,
778427,
192338,
327614,
637456,
622874,
995452,
1111787,
991694,
1392654,
754859,
642495,
415716,
130257,
98,
1438406,
160095,
192406,
931544,
1354580,
186835,
1271813,
1239622,
226898,
1023407,
994122,
748692,
1141178,
311282,
222918,
185558,
145697,
1206316,
194,
1069288,
145592,
985271,
685841,
1274683,
1249803,
1214949,
320493,
1141187,
1093829,
1058211,
607821,
796505,
1123780,
417442,
1099500,
63,
1460398,
241152,
192415,
144543,
887812,
894065,
146111,
127846,
1369728,
192363,
226860,
1208222,
1192774,
1060367,
1050638,
1059594,
705782,
136,
795930,
135121,
145002,
145060,
1266945,
1259828,
1239291,
637458,
642725,
1089076,
1112613,
1099549,
731000,
131614,
1420825,
301,
356,
146320,
778396,
1290124,
1122903,
1256770,
326258,
1118180,
668843,
934194,
1121811,
1158595,
145048,
730993,
1429096,
144517,
1395234,
144956,
1360749,
1326020,
192373,
209367,
226786,
317720,
1141185,
580966,
982767,
743714,
316712,
8037,
763815,
1163414,
1460940,
1443198,
902477,
1384724,
192372,
209414,
1192792,
619917,
922536,
325808,
242,
137642,
145599,
127852,
558451,
1355098,
1291169,
1266874,
346037,
1085713,
589374,
673760,
1138941,
823654,
1438397,
171072,
144964,
145022,
132995,
145053,
145689,
148584,
1259802,
226791,
1201619,
1195190,
1155868,
1122865,
1190161,
1225901,
7,
60,
1392645,
145571,
209417,
1225375,
1162435,
1118658,
1061897,
1188929,
788574,
244,
1429531,
835508,
1411202,
940188,
743689,
1305033,
1071509,
995114,
994091,
1059133,
1100745,
130343,
1411206,
1251552,
1094039,
995480,
1043751,
1201633,
1465425,
111,
134081,
377688,
755192,
1300028,
1059865,
226788,
226818,
1157626,
1050841,
1058911,
1157628,
1144104,
158197,
172,
730517,
6,
730785,
1043394,
1162215,
1369751,
149169,
667506,
226808,
894638,
1059208,
1019784,
1141278,
181,
1479598,
788553,
1162137,
133665,
213,
259,
153870,
1043754,
1236854,
226843,
328881,
337573,
1058953,
940341,
730991,
622797,
1140959,
375,
1469419,
936824,
145038,
1274072,
1235339,
313723,
580976,
705801,
839367,
971202,
1058889,
1118194,
106899,
92,
830433,
275,
140463,
313922,
672952,
1276132,
203088,
1154427,
433457,
1119256,
995178,
995107,
993651,
922481,
894524,
443605,
204,
1392652,
743691,
1277510,
1213422,
1100909,
1058745,
987911,
1120912,
160022,
1203023,
763814,
152902,
209419,
1208195,
323793,
722069,
884135,
1058893,
1058888,
795063,
1100750,
524021,
1141878,
136726,
135690,
10,
262,
1018859,
146324,
1108667,
1251693,
1210284,
316519,
471240,
622594,
642656,
665777,
1060358,
127494,
132631,
887203,
106963,
179645,
1266849,
209388,
889671,
226815,
418413,
643125,
667979,
1058896,
840893,
792255,
1387090,
226811,
987928,
146319,
152906,
209401,
1091902,
1117512,
1230186,
1188006,
1468911,
145583,
871178,
185578,
142945,
1403170,
298,
6764,
192337,
1204593,
1090996,
668857,
1002897,
806745,
133149,
138988,
830430,
232,
1434932,
969075,
743694,
1334631,
1326036,
185568,
847152,
1275495,
212364,
308153,
592986,
619209,
1001604,
1058821,
988871,
712515,
1078502,
47,
1443190,
843154,
1384740,
145788,
1251638,
1225371,
1162200,
1108605,
642668,
1043047,
953780,
997671,
987954,
343156,
226862,
1218525,
999755,
136582,
1278301,
209383,
1061904,
1231055,
1214931,
1100243,
905133,
160131,
325,
293,
8259,
533016,
185566,
1171641,
957521,
1292589,
1272016,
226795,
1251014,
391628,
478879,
1089197,
668846,
934195,
926476,
743720,
988858,
1218509,
227,
184,
55,
120,
1429529,
6787,
1392416,
380496,
209561,
1203252,
1108890,
635787,
1219053,
1218512,
991693,
1230185,
23,
1445880,
145062,
145560,
573612,
145727,
754679,
1202344,
563376,
934235,
843424,
1230098,
902478,
145594,
186824,
1251656,
226798,
557637,
987915,
1116648,
1230044,
730998,
730766,
134083,
135676,
186814,
186834,
1271912,
1161928,
1116662,
641033,
185570,
1192771,
8029,
52,
130266,
134096,
135817,
146240,
685806,
1278299,
192336,
1269357,
226827,
1192162,
1023254,
635235,
635788,
1099954,
730996,
236,
226823,
323852,
350413,
743711,
1443795,
1441032,
135063,
6781,
1384728,
1290344,
1264997,
377689,
508721,
144548,
150955,
145796,
581127,
685853,
684399,
635786,
987921,
1138949,
1471051,
133808,
1417309,
946581,
144959,
1040001,
250305,
685795,
1325993,
934247,
1031773,
1214995,
1212145,
994125,
934239,
879017,
830112,
1141843,
145037,
1314567,
1272009,
1218724,
580989,
984781,
905130,
1155656,
337413,
1230100,
77,
1467184,
85,
1067450,
133565,
1434938,
898652,
1395277,
198315,
342545,
1091895,
701518,
1010714,
995207,
781204,
1031790,
797864,
145109,
828460,
1404228,
1275533,
192365,
1251615,
995119,
905136,
1058878,
463872,
1162127,
145058,
107111,
803712,
132013,
170,
1443196,
250,
922503,
988873,
1239910,
1188062,
618466,
1182096,
335832,
145551,
75,
1162208,
133661,
144926,
997599,
1353395,
153025,
1270391,
287479,
553144,
988860,
838284,
987923,
241338,
226801,
681749,
30,
987074,
1235355,
397611,
527749,
622296,
1060366,
994124,
934241,
834293,
987906,
987930,
643381,
635792,
1060362,
222919,
31,
730779,
1005013,
133222,
146057,
160085,
160138,
1392649,
922237,
149170,
1291890,
1290924,
975691,
1255856,
482024,
1144144,
8043,
130514,
833913,
1411208,
142944,
144547,
185563,
145794,
192351,
226803,
1221308,
1121806,
641639,
670457,
975703,
1032696,
988866,
1203106,
6796,
1443192,
136019,
1406050,
316,
1171932,
754681,
1314546,
186826,
1185711,
622558,
588740,
995176,
953785,
1059517,
1058852,
135884,
1435933,
754861,
242235,
1093976,
684420,
1123233,
1089079,
1155862,
1118405,
821941,
1397257,
1374784,
1291118,
1277848,
1231050,
1195183,
335450,
8481,
527983,
685661,
1467183,
133695,
135685,
261,
1400268,
145045,
1323888,
472555,
1252022,
226796,
1210345,
643403,
1058947,
701517,
587592,
878132,
923692,
670464,
555002,
222784,
1202381,
7176,
836062,
129098,
1329785,
192408,
1155866,
1265454,
1235501,
1155659,
432110,
1056244,
749431,
561215,
526850,
1061898,
1215014,
1100085,
256,
1494594,
241151,
151025,
755101,
152903,
153914,
1275231,
226816,
1218517,
333951,
763147,
1461157,
839037,
160135,
107127,
1244356,
277471,
1190221,
1150255,
1108879,
1021930,
924046,
987948,
569444,
1161251,
305033,
152001,
999752,
145597,
136649,
133669,
1386897,
987955,
226903,
637457,
757881,
921095,
1004572,
1192778,
466941,
1323391,
1274154,
359511,
1059218,
705787,
380501,
1139221,
226885,
4,
1047182,
743697,
1266942,
724562,
1058874,
991714,
176,
203,
1437457,
278,
141857,
1344315,
1299993,
153912,
203146,
425531,
1105338,
887827,
802077,
1125002,
1155857,
144939,
1459330,
192366,
1235302,
1100753,
376467,
1471362,
133801,
839332,
1321940,
153899,
226835,
241148,
580971,
1123878,
226864,
1386937,
477438,
1299491,
1277691,
1275515,
226865,
1031774,
198,
133250,
1338625,
1320810,
1266489,
396218,
781201,
902075,
992786,
1215001,
1494598,
860700,
237,
1092693,
1445871,
1438481,
894109,
307,
145013,
1387042,
145706,
563298,
1275257,
1238847,
226848,
463769,
1091830,
623586,
722070,
839358,
975484,
1058859,
616889,
93,
133689,
192371,
1256027,
1121821,
1144029,
1139206,
253393,
230627,
226846,
159896,
8214,
135968,
1300988,
1290995,
226831,
1230084,
226879,
1142526,
1061900,
898843,
542525,
472367,
1151679,
1462934,
132107,
144546,
1392663,
1392632,
986931,
146239,
1291146,
1222175,
355108,
645397,
1050554,
934243,
146325,
1463568,
133252,
1445879,
1432092,
151021,
1314549,
1299474,
192346,
222935,
1249344,
1227504,
1218719,
241147,
1209007,
607483,
701405,
921099,
926478,
1121892,
1083660,
348030,
130346,
134056,
212,
171077,
258,
271,
145028,
145043,
1017425,
685845,
226794,
226866,
391629,
580984,
1061892,
1144135,
119,
7178,
127164,
1460344,
1438479,
239,
1404239,
1392633,
145018,
1172645,
145792,
192364,
642685,
1058912,
572728,
1144203,
145831,
3,
826853,
1432338,
192411,
1259810,
226857,
995580,
1182112,
312518,
685488,
133560,
1444486,
1275531,
1272091,
209471,
569450,
701641,
905137,
479343,
150780,
230,
1463547,
132088,
1329788,
755189,
1255831,
380502,
1058910,
1043340,
795849,
1061934,
145041,
1372264,
1272087,
226841,
1201634,
462214,
1034575,
1151702,
1463675,
192383,
242232,
300046,
1038680,
6756,
780897,
303,
329,
1291962,
757899,
934201,
890300,
1236148,
226892,
1108875,
1096991,
1056226,
987925,
472366,
17,
806721,
794692,
1429561,
229891,
1395159,
1291172,
1266940,
988870,
1235493,
226872,
1141796,
1116687,
1056324,
991707,
932388,
841673,
821943,
1118173,
433934,
1061886,
1201736,
207533,
361,
730771,
1460330,
1162947,
133864,
144961,
128163,
999697,
743707,
519243,
1031789,
205480,
889673,
222915,
317984,
346111,
1156311,
417443,
1140976,
833947,
1056251,
992784,
660939,
1158503,
1142500,
1144122,
1235523,
144927,
1196510,
154,
1441029,
171086,
272,
1384726,
983416,
145720,
192357,
209562,
1093839,
757882,
1058816,
791415,
1089085,
1181815,
145711,
140381,
1463669,
1445885,
135954,
241128,
898650,
208325,
1171639,
1294697,
1230085,
1155865,
308155,
1071299,
847159,
1117415,
659215,
1155654,
1154429,
999757,
1471811,
228,
1460937,
803928,
1383725,
1376166,
755073,
668861,
1050551,
1059392,
481995,
1043064,
234,
743718,
755038,
1195137,
241144,
1093825,
995108,
975694,
934182,
952810,
754152,
725695,
1230064,
207,
408479,
125854,
881944,
1325543,
1150261,
1061903,
1265452,
1238844,
567580,
991655,
1196511,
199,
1171986,
153916,
327879,
730774,
251,
136732,
1100245,
1300029,
192347,
992455,
226859,
463751,
432109,
558376,
1056238,
109023,
1445886,
880525,
908939,
1335117,
160409,
226805,
1214035,
679001,
1031787,
730994,
49,
1462930,
1384731,
1201471,
1265445,
226804,
839377,
988867,
1230086,
215,
135422,
248,
222916,
151275,
150829,
192344,
326260,
1158597,
1155860,
1142497,
1137670,
637459,
705780,
987913,
642493,
1141459,
451047,
145708,
1020985,
762900,
132044,
147235,
160088,
890573,
292,
28,
924270,
757079,
802201,
1201737,
347672,
1100734,
1088330,
665420,
1177835,
19,
772939,
808709,
1445483,
141858,
1384735,
148583,
781193,
1230092,
1206461,
326250,
661492,
617315,
1031784,
1155858,
1218521,
136706,
187,
192422,
142950,
144953,
982601,
293568,
743692,
250317,
186821,
192343,
1266453,
1171565,
1162126,
1120716,
595434,
723576,
954788,
685813,
1121814,
834027,
135682,
1435718,
1400362,
1369776,
209403,
226830,
241140,
905128,
1031776,
1031788,
882468,
988857,
1117523,
380513,
1182107,
1099616,
140382,
217,
1406056,
934607,
778377,
1265456,
1163293,
526858,
1141464,
130448,
131901,
130309,
884067,
1277280,
192359,
246732,
1142493,
789884,
662012,
220636,
132049,
1163007,
192409,
1387041,
226789,
1251617,
858202,
1182099,
806206,
842965,
150775,
1161881,
107000,
1043206,
132034,
982836,
149124,
1326005,
1275455,
1265455,
1249341,
1050826,
987934,
1031781,
1192773,
1463673,
144976,
208327,
847158,
1138951,
1060354,
1235469,
684755,
1479603,
1096995,
130517,
1162707,
1387009,
145580,
1329348,
751525,
130489,
1163262,
817719,
838272,
830096,
466965,
152901,
1239666,
1231133,
314070,
432408,
1075512,
795370,
1121600,
573182,
296820,
160133,
794333,
273,
1395268,
144954,
145061,
145723,
145746,
1277408,
1162125,
508759,
1120523,
663019,
642657,
988855,
957469,
804125,
1100267,
988859,
1118541,
1060369,
1201637,
193806,
21,
818153,
1369774,
149147,
748679,
226783,
1211503,
1059103,
326245,
161023,
806743,
279,
145793,
226814,
226838,
373098,
641595,
684415,
829903,
820444,
781620,
1154948,
1099984,
991710,
70,
130449,
761973,
1163366,
133671,
1438129,
160159,
314,
145780,
1271979,
463754,
620610,
781608,
705785,
468468,
127858,
1485835,
151,
1411101,
931984,
1384727,
743715,
554085,
725703,
1259829,
1253350,
1239292,
472551,
1091900,
603776,
1058858,
623265,
18,
1063728,
133842,
148576,
148582,
755090,
889686,
1224948,
884145,
1122701,
1215013,
991711,
1230193,
1438736,
136003,
900197,
946654,
743695,
934203,
1007711,
781224,
921098,
1061895,
1219050,
1462932,
1404226,
145070,
1354422,
995481,
992785,
1121796,
160087,
1400247,
144957,
212894,
1231141,
642667,
1108664,
1230205,
149145,
226793,
1239365,
241139,
581143,
1141297,
1441036,
883961,
1363406,
226828,
341554,
681975,
127139,
362,
116345,
982500,
159197,
192348,
1060373,
226884,
250126,
1141005,
425599,
1095584,
645316,
661873,
589366,
641073,
834458,
787787,
1141176,
380498,
821895,
1443205,
134075,
286,
1386309,
1379454,
1154456,
1196833,
643348,
1031797,
645572,
1142483,
1201623,
144951,
353,
310,
1342297,
1325531,
1100921,
226826,
463746,
1100995,
642652,
999773,
858037,
884143,
1058439,
341725,
157954,
134079,
133529,
131733,
127562,
880770,
285,
302,
145044,
915742,
318890,
954058,
847156,
1058862,
754386,
1061893,
308,
71,
127584,
830141,
145064,
149123,
890294,
324199,
417441,
588403,
722068,
1058909,
830429,
554558,
1060371,
1187516,
160410,
991622,
132420,
334,
1096992,
133138,
471944,
151288,
1238349,
262381,
643142,
701628,
1043744,
988869,
1089208,
326252,
1043291,
48,
130492,
795828,
326249,
358118,
668850,
1010799,
1189886,
1177834,
133563,
339724,
1429111,
241131,
145747,
1241709,
1238851,
1236140,
1213107,
1155859,
471387,
995183,
192431,
1437070,
1392625,
192423,
329680,
580977,
637454,
603511,
1031785,
1043077,
1158508,
1061901,
1480699,
141293,
290,
1395221,
995491,
722071,
987916,
1089215,
1060360,
1100717,
136644,
1274688,
226829,
348250,
1054355,
988856,
1061891,
1181771,
127486,
806758,
1271745,
1245729,
1141296,
507502,
995115,
1099799,
105,
131898,
1429124,
246729,
145031,
755121,
192358,
1266944,
796496,
1230819,
226868,
359532,
480264,
997116,
886173,
1050578,
621159,
1150251,
380503,
100,
73,
1463014,
1428533,
1392637,
145684,
1171933,
743701,
718154,
405922,
685663,
145071,
231,
1314570,
160412,
838731,
1058898,
209408,
1211504,
580988,
879951,
1058904,
1121014,
667981,
1141430,
1201636,
270,
1063862,
115,
841058,
145020,
226886,
1141462,
1094513,
892845,
987956,
1215011,
798031,
1441031,
145696,
1316000,
838728,
1230913,
1219048,
995220,
987947,
1111794,
313747,
1181784,
80,
107,
135424,
241156,
1400251,
331,
969199,
7170,
113714,
1386237,
1126891,
463756,
600930,
616680,
914141,
860333,
826673,
1056235,
1058209,
803796,
777681,
1141279,
1061896,
226877,
1218494,
730992,
220,
828461,
1438164,
1406321,
1271988,
226845,
1229987,
1158596,
514831,
637460,
1058875,
1058837,
1155657,
1141280,
804121,
821476,
890615,
241153,
573606,
1095583,
924061,
1031783,
1050839,
701633,
342567,
297,
317,
1427319,
894933,
1375294,
1363808,
1320863,
226863,
226875,
705791,
751524,
925139,
1059844,
1019800,
1061889,
1192753,
133264,
133253,
145049,
1278653,
1266941,
226799,
1208906,
1196207,
1064389,
988874,
1230060,
1353496,
1329325,
153920,
179672,
192386,
226781,
1230915,
477128,
1489210,
786879,
1438172,
838246,
1436124,
145738,
1275112,
1238382,
226901,
1214124,
373101,
463750,
533714,
1091911,
994104,
1162132,
1096954,
115611,
138,
295396,
755087,
1290396,
209373,
226836,
284260,
781616,
879923,
905134,
934244,
975695,
668866,
1182098,
1060361,
334058,
1197251,
127569,
130306,
1460948,
818199,
107134,
145963,
145554,
149121,
573615,
1288259,
1269891,
1235069,
1213109,
472211,
1118068,
635791,
991413,
1031778,
827299,
757898,
226887,
1218500,
160781,
1177850,
136007,
135674,
731550,
792293,
136657,
1174180,
569491,
754900,
326259,
642664,
975696,
642496,
1182109,
1442111,
1437449,
885458,
894899,
1172730,
558363,
192350,
1265451,
209420,
1162134,
1161905,
1058767,
1070607,
362021,
145034,
113718,
35,
1004874,
305,
1350216,
724561,
975698,
192360,
1056514,
1005176,
670458,
1031780,
993505,
835979,
670461,
1162115,
1060359,
1201143,
14,
800486,
1100932,
158470,
1334969,
156877,
318025,
626164,
1058981,
1010814,
1140956,
1150242,
1060355,
991706,
108896,
885456,
241145,
144545,
1394506,
148577,
106902,
1278302,
209379,
1254913,
226861,
318569,
666312,
995484,
1061899,
1230058,
196,
1400264,
312,
149122,
801684,
145732,
230625,
1196821,
1119901,
1091868,
1097074,
1186395,
159191,
145587,
144950,
1097500,
890479,
6763,
1342017,
1290388,
1265446,
463752,
1091188,
991627,
569452,
1138947,
1154426,
1192769,
860417,
146272,
241157,
1355183,
152900,
1271962,
1259808,
620840,
132657,
145588,
1251551,
1245712,
226902,
352355,
1090236,
1058902,
1218515,
145694,
1211968,
478608,
1058751,
987909,
1060365,
991695,
1230189,
804130,
333,
145036,
145067,
462674,
1134950,
1346262,
148581,
241149,
1196031,
1182275,
1154410,
580972,
1064316,
1059379,
668860,
659365,
806750,
1058885,
1155652,
403762,
118524,
57,
391631,
743717,
151304,
1050193,
192389,
1137693,
463595,
1123217,
341316,
553146,
668854,
998335,
879946,
533019,
1060357,
1230754,
127140,
306,
143,
195,
149127,
135677,
106962,
145069,
145688,
1364055,
1329446,
725692,
747558,
757892,
1192693,
1118536,
1017476,
976214,
969907,
934181,
975702,
1050834,
685489,
1140965,
1182104,
294409,
818056,
158471,
135683,
1411047,
968524,
1389666,
145952,
1363135,
763974,
1100874,
635789,
664630,
228087,
483740,
1202571,
118,
1417516,
883974,
755177,
1321977,
186810,
260722,
1201624,
1179666,
1162116,
1093816,
1058870,
1020006,
905132,
1108665,
1118585,
1138921,
1155589,
144948,
138982,
111166,
160134,
245,
192424,
145847,
203142,
150785,
1266480,
226890,
242233,
1194328,
995113,
903474,
932122,
1019776,
1151703,
463565,
353245,
133259,
145108,
1399857,
144960,
1384736,
149126,
192349,
1275243,
1100963,
1151705,
466967,
642665,
1041700,
977739,
160132,
134080,
135423,
818205,
142953,
241340,
148569,
755167,
778385,
1058914,
722066,
905131,
885635,
568819,
1182095,
991702,
1493884,
504995,
1305980,
152904,
1238841,
1155590,
1058897,
839372,
924070,
991696,
1091335,
160160,
332,
145595,
685794,
192378,
203089,
1251640,
314436,
1118695,
645584,
643136,
668869,
932660,
757895,
130345,
282,
145715,
1162128,
1267225,
1258595,
1182105,
1110708,
1099724,
1022072,
1444428,
1353552,
781192,
179654,
1272089,
1267290,
1259670,
226876,
597855,
1120876,
991708,
42,
265,
338956,
319,
1172218,
1150260,
1174177,
1118599,
1031775,
924049,
757894,
1100743,
1140973,
1201628,
1229910,
133564,
900026,
1171909,
1299484,
1243295,
226880,
226905,
281097,
408423,
642098,
670462,
934196,
898797,
835964,
222912,
144947,
314967,
146702,
150685,
192381,
1150220,
1254906,
1245783,
263255,
321521,
329768,
433997,
418079,
527747,
672181,
641068,
748398,
1001877,
1017206,
987919,
1100752,
246726,
1225902,
243,
1043342,
127568,
134067,
145835,
1420821,
145075,
1326049,
991625,
1230909,
1218496,
1213117,
296878,
311485,
604756,
890290,
1049884,
1056320,
658462,
193807,
991692,
1494602,
12,
1071624,
145010,
307515,
884330,
380500,
1192793,
364,
113,
61,
127554,
823322,
145717,
1301577,
192340,
192356,
314302,
1144100,
920891,
1141186,
417968,
226852,
1177852,
146120,
185,
806753,
871927,
253,
894110,
145068,
754828,
226813,
1125040,
1071552,
617281,
687482,
991698,
145033,
1353263,
1314555,
1300032,
186809,
1279255,
192345,
226881,
362492,
610536,
1060372,
987926,
123494,
1384733,
145601,
725694,
754854,
1291142,
1254008,
1230091,
287482,
301549,
463748,
668852,
287483,
127501,
318,
106922,
144540,
466953,
192404,
1091837,
668848,
1200854,
730999,
1486850,
107003,
932081,
1197793,
308309,
313920,
1058762,
988868,
1120879,
1158584,
1150240,
109000,
135047,
1425808,
241146,
152905,
1061890)

                          --   and json_extract_path_text(json_extract_array_element_text(cq.question_skills_obj,seq.n, true),'name', true) not like '% (Basic)%'

                          )


      select

      date_trunc('month', solve_inserttime) as month_year,
      dim_recruit_test.test_company_id as test_company_id,
      lib_q_skill_map.modified_skill_name  AS "lib_q_skill_map.modified_skill_name",
          COUNT(DISTINCT lib_q_skill_map.question_id ) AS "lib_q_skill_map.question_count",
          COUNT(DISTINCT fact_recruit_solve.solve_id ) AS "fact_recruit_solve.solve_count",
          COUNT(DISTINCT case when  fact_recruit_solve.solve_metadata_max_score = fact_recruit_solve.solve_score then fact_recruit_solve.solve_id end ) AS "fact_recruit_solve.full_score_solve_count",
          count(distinct attempt_id) as total_attempts,
          count(distinct dim_recruit_test.test_id) as distinct_tests,
          count(distinct ever_paid_accounts.company_id) as distinct_customers,
          count(distinct fact_recruit_attempt.attempt_email) as distinct_candidates_attempted,
          count(distinct case when  fact_recruit_solve.solve_metadata_max_score = fact_recruit_solve.solve_score then fact_recruit_attempt.attempt_email end) as distinct_candidates_full_score


      from lib_q_skill_map

      INNER JOIN hr_analytics.global.fact_recruit_solve  AS fact_recruit_solve ON lib_q_skill_map.question_id = fact_recruit_solve.solve_question_id
                  and fact_recruit_solve.solve_status = 2
                  and solve_attempt_id > 0  -- Consider Only Final Submissions
                  and date(fact_recruit_solve.solve_inserttime) >= '2019-01-01'
                  -- and date(fact_recruit_solve.solve_inserttime) <= '2022-06-30'

      INNER JOIN hr_analytics.global.fact_recruit_attempt  AS fact_recruit_attempt ON fact_recruit_solve.solve_attempt_id = fact_recruit_attempt.attempt_id
      INNER JOIN hr_analytics.global.dim_recruit_test  AS dim_recruit_test ON fact_recruit_attempt.attempt_test_id = dim_recruit_test.test_id
                  and dim_recruit_test.test_draft = 0
                  and dim_recruit_test.test_state <> 3

      -- INNER JOIN hr_analytics.global.dim_recruit_company  AS dim_recruit_company ON dim_recruit_test.test_company_id = dim_recruit_company.company_id
      --       and lower(company_name) not like '%hackerrank%'
      --       and lower(company_name) not like '%hacker%rank%'
      --       and lower(company_name) not like '%interviewstreet%'
      --       and lower(company_name) not like '%interview%street%'
      --       and company_name not like 'Company%'

      --       and dim_recruit_company.company_id not in (65904,107170) --- exclude tcs  lnd accounts
      --       and dim_recruit_company.company_id not in (106529,46242) --- exclude internal test setters

      --       and company_stripe_plan not in ('free', 'trial','user-freemium-interviews-v1','locked')  --- get currently active customers
      --       and company_type not in ('free', 'trial','locked')

      INNER JOIN
          (with ever_paid as
              (

              select distinct company_plan_changelog_company_id as company_id from hr_analytics.global.fact_recruit_company_plan_changelog
                      where company_plan_changelog_plan_name not in ('free', 'trial', 'user-freemium-interviews-v1','locked') -- # ever paid customers (This table has data only of companies created post 2018)
              ---- ^ Above query returns ever paid customer who joined 2018 onwards
              union
              select distinct company_id from hr_analytics.global.dim_recruit_company rc
                where company_stripe_plan not in ('free', 'trial','user-freemium-interviews-v1','locked')
                and company_type not in ('free', 'trial','locked')  -- # using this logic to cover paid customers who are not covered in the above logic [company_plan_changelog table]

                ---- ^ currently active customers being missed out on prev query (2018 onwards set)
                )

          Select rc.*
          from
          hr_analytics.global.dim_recruit_company rc  inner join ever_paid ep on ep.company_id=rc.company_id

          inner join hr_analytics.global.dim_recruit_user ru on ru.user_id=rc.company_owner  ---- filter internal test accounts created by HR users themselves
          and lower(ru.user_email) not like '%@hackerrank.com%'
          and lower(ru.user_email) not like '%@hackerrank.net%'
          and lower(ru.user_email) not like '%@interviewstreet.com%'
          and lower(ru.user_email) not like '%sandbox17e2d93e4afe44ea889d89aadf6d413f.mailgun.org%'
          and lower(ru.user_email) not like '%strongqa.com%'

          where lower(company_name) not in ('none', ' ', 'hackerrank','interviewstreet') --- Filter internal accounts based on company names
          and lower(company_name) not like '%hackerrank%'
          and lower(company_name) not like '%hacker%rank%'
          and lower(company_name) not like '%interviewstreet%'
          and lower(company_name) not like '%interview%street%'
          and company_name not like 'Company%'

          and rc.company_id not in (65904,107170) --- exclude tcs  lnd accounts
          and rc.company_id not in (106529,46242) --- exclude internal test setters
          ) as ever_paid_accounts

          ON dim_recruit_test.test_company_id = ever_paid_accounts.company_id
          -- and lib_q_skill_map.modified_skill_name in ('SQL','C++','C#','Bash','Problem Solving','REST API','Java','Python','.NET','Angular','React','HTML/CSS/JS','Express.js','Node.js','Spring Boot','Selenium','Machine Learning','Docker','Linux','Kubernetes','Django','Data Wrangling','Data Visualization','Data Modeling')

      group by 1,2,3
      order by 1,2,3 ;;
    }

    measure: count {
      type: count
      drill_fields: [detail*]
    }

    dimension_group: month_year {
      type: time
      sql: ${TABLE}.month_year ;;
    }

  dimension: test_company_id {
    type: number
    sql: ${TABLE}."test_company_id" ;;
  }


    dimension: lib_q_skill_map_modified_skill_name {
      type: string
      sql: ${TABLE}."lib_q_skill_map.modified_skill_name" ;;
    }

    dimension: lib_q_skill_map_question_count {
      type: number
      sql: ${TABLE}."lib_q_skill_map.question_count" ;;
    }

    dimension: fact_recruit_solve_solve_count {
      type: number
      sql: ${TABLE}."fact_recruit_solve.solve_count" ;;
    }

    dimension: fact_recruit_solve_full_score_solve_count {
      type: number
      sql: ${TABLE}."fact_recruit_solve.full_score_solve_count" ;;
    }

    dimension: total_attempts {
      type: number
      sql: ${TABLE}.total_attempts ;;
    }

    dimension: distinct_tests {
      type: number
      sql: ${TABLE}.distinct_tests ;;
    }

    dimension: distinct_customers {
      type: number
      sql: ${TABLE}.distinct_customers ;;
    }

    dimension: distinct_candidates_attempted {
      type: number
      sql: ${TABLE}.distinct_candidates_attempted ;;
    }

    dimension: distinct_candidates_full_score {
      type: number
      sql: ${TABLE}.distinct_candidates_full_score ;;
    }

    set: detail {
      fields: [
        month_year_time,
        lib_q_skill_map_modified_skill_name,
        test_company_id,
        lib_q_skill_map_question_count,
        fact_recruit_solve_solve_count,
        fact_recruit_solve_full_score_solve_count,
        total_attempts,
        distinct_tests,
        distinct_customers,
        distinct_candidates_attempted,
        distinct_candidates_full_score
      ]
    }
  }
